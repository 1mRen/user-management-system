import{a as X}from"./chunk-ZLLZQGU7.js";import{a as w,e as _}from"./chunk-UYVSYKOO.js";import{$ as I,A as o,B as n,C as R,Ca as K,F as $,Fa as Y,G as W,H as k,Ha as z,Ia as G,Ja as J,Ka as Q,L as r,M as v,Ma as j,N as d,P as A,U as F,V as E,W as D,Y as q,aa as C,ba as b,da as B,ea as U,ga as P,j as u,m as M,n as S,o as O,p as f,q as x,r as T,s as N,u as l,v as m,w as h,x as s,ya as V,za as H}from"./chunk-ZYNGRVCC.js";var ee=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=f({type:t,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"p-4"],[1,"container"]],template:function(i,a){i&1&&(o(0,"div",0)(1,"div",1),R(2,"router-outlet"),n()())},dependencies:[G],encapsulation:2})}}return t})();var L=(()=>{class t{constructor(e){this.http=e}getAll(){return this.http.get(`${w.apiUrl}/workflows`)}getByEmployeeId(e){return this.http.get(`${w.apiUrl}/workflows/employees/${e}`)}create(e){return this.http.post(`${w.apiUrl}/workflows`,e)}updateStatus(e,i){return this.http.put(`${w.apiUrl}/workflows/${e}/status`,i)}initiateOnboarding(e){return this.http.post(`${w.apiUrl}/workflows/onboarding`,e)}static{this.\u0275fac=function(i){return new(i||t)(O(P))}}static{this.\u0275prov=M({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ie=t=>["/admin/workflows/employee",t],pe=(t,p,e)=>({"bg-warning":t,"bg-success":p,"bg-danger":e});function me(t,p){if(t&1&&(o(0,"tr")(1,"td")(2,"a",5),r(3),n()(),o(4,"td"),r(5),n(),o(6,"td")(7,"span",6),r(8),n()(),o(9,"td"),r(10),D(11,"date"),n(),o(12,"td")(13,"div",7)(14,"button",8),r(15,"View"),n()()()()),t&2){let e=p.$implicit;l(2),s("routerLink",F(10,ie,e.employeeId)),l(),v(e.employeeId),l(2),v(e.type),l(2),s("ngClass",E(12,pe,e.status.toLowerCase()==="pending",e.status.toLowerCase()==="completed"||e.status.toLowerCase()==="approved",e.status.toLowerCase()==="cancelled"||e.status.toLowerCase()==="rejected")),l(),d(" ",e.status," "),l(2),v(q(11,7,e.created,"medium")),l(4),s("routerLink",F(16,ie,e.employeeId))}}function de(t,p){t&1&&(o(0,"tr")(1,"td",9)(2,"span",10),r(3,"No workflows found"),n()()())}var oe=(()=>{class t{constructor(e,i){this.workflowService=e,this.alertService=i,this.workflows=[]}ngOnInit(){this.workflowService.getAll().pipe(u()).subscribe({next:e=>{this.workflows=e},error:e=>{this.alertService.error(e)}})}static{this.\u0275fac=function(i){return new(i||t)(m(L),m(_))}}static{this.\u0275cmp=f({type:t,selectors:[["ng-component"]],decls:20,vars:2,consts:[[1,"card"],[1,"card-body"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"routerLink"],[1,"badge",3,"ngClass"],[1,"btn-group"],[1,"btn","btn-sm","btn-primary",3,"routerLink"],["colspan","5",1,"text-center"],[1,"p-2"]],template:function(i,a){i&1&&(o(0,"h1"),r(1,"Workflows"),n(),o(2,"div",0)(3,"div",1)(4,"table",2)(5,"thead")(6,"tr")(7,"th"),r(8,"Employee ID"),n(),o(9,"th"),r(10,"Type"),n(),o(11,"th"),r(12,"Status"),n(),o(13,"th"),r(14,"Created"),n(),o(15,"th"),r(16,"Actions"),n()()(),o(17,"tbody"),h(18,me,16,18,"tr",3)(19,de,4,0,"tr",4),n()()()()),i&2&&(l(18),s("ngForOf",a.workflows),l(),s("ngIf",!a.workflows.length))},dependencies:[I,C,b,Q,B],encapsulation:2})}}return t})();var ce=(t,p,e)=>({"bg-warning text-dark":t,"bg-success":p,"bg-danger":e});function ue(t,p){if(t&1&&(o(0,"div"),r(1),n()),t&2){let e=k().$implicit;l(),d(" Task: ",(e.details==null?null:e.details.task)||"Setup workstation"," ")}}function fe(t,p){if(t&1&&(o(0,"div")(1,"div"),r(2),n(),o(3,"div"),r(4),n(),o(5,"div"),r(6),n(),o(7,"div"),r(8),n()()),t&2){let e,i=k().$implicit;l(2),d("requestId: ",(i.details==null?null:i.details.requestId)||"N/A",""),l(2),d("requestType: ",(i.details==null?null:i.details.requestType)||((e=i.type.split(":")[1])==null?null:e.trim()),""),l(2),d("requesterId: ",i.employeeId,""),l(2),A("message: Review ",(i.details==null?null:i.details.requestType)||"request"," #",i.details==null?null:i.details.requestId," from Employee ID ",i.employeeId,".")}}function ve(t,p){if(t&1){let e=$();o(0,"tr")(1,"td"),r(2),n(),o(3,"td"),h(4,ue,2,1,"div",6)(5,fe,9,6,"div",6),n(),o(6,"td")(7,"span",9),r(8),n()(),o(9,"td")(10,"div",10)(11,"select",11),W("change",function(a){let c=T(e).$implicit,y=k();return N(y.updateStatus(c.id,a))}),o(12,"option",12),r(13,"Pending"),n(),o(14,"option",13),r(15,"Approved"),n(),o(16,"option",14),r(17,"Rejected"),n(),o(18,"option",15),r(19,"Completed"),n(),o(20,"option",16),r(21,"Cancelled"),n()()()()()}if(t&2){let e=p.$implicit;l(2),v(e.type),l(2),s("ngIf",e.type==="Onboarding"),l(),s("ngIf",e.type.startsWith("Request:")),l(2),s("ngClass",E(6,ce,e.status.toLowerCase()==="pending",e.status.toLowerCase()==="completed"||e.status.toLowerCase()==="approved",e.status.toLowerCase()==="cancelled"||e.status.toLowerCase()==="rejected")),l(),d(" ",e.status," "),l(3),s("value",e.status)}}function we(t,p){t&1&&(o(0,"tr")(1,"td",17)(2,"span",18),r(3,"No workflows found for this employee"),n()()())}var ne=(()=>{class t{constructor(e,i,a,c,y,le){this.route=e,this.router=i,this.workflowService=a,this.employeeService=c,this.alertService=y,this.formBuilder=le,this.workflows=[],this.loading=!1}ngOnInit(){this.employeeId=this.route.snapshot.params.id,this.loading=!0,this.employeeService.getById(parseInt(this.employeeId)).pipe(u()).subscribe({next:e=>{this.employee=e,this.loadWorkflows()},error:e=>{this.alertService.error("Error loading employee details"),this.loading=!1}})}loadWorkflows(){this.workflowService.getByEmployeeId(parseInt(this.employeeId)).pipe(u()).subscribe({next:e=>{this.workflows=e,this.loading=!1},error:e=>{this.alertService.error("Error loading workflows"),this.loading=!1}})}updateStatus(e,i){let c=i.target.value;this.workflowService.updateStatus(e,{status:c}).pipe(u()).subscribe({next:()=>{this.alertService.success("Workflow status updated successfully"),this.loadWorkflows()},error:y=>{this.alertService.error("Error updating workflow status")}})}goBack(){this.router.navigate(["/admin/employees"])}static{this.\u0275fac=function(i){return new(i||t)(m(z),m(J),m(L),m(X),m(_),m(K))}}static{this.\u0275cmp=f({type:t,selectors:[["ng-component"]],decls:22,vars:3,consts:[[1,"card"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],[1,"table","table-bordered","table-hover"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"card-footer","d-flex","justify-content-end"],[1,"btn","btn-secondary",3,"click"],[1,"badge",3,"ngClass"],[1,"dropdown"],[1,"form-select","form-select-sm",3,"change","value"],["value","Pending"],["value","Approved"],["value","Rejected"],["value","Completed"],["value","Cancelled"],["colspan","4",1,"text-center"],[1,"p-2"]],template:function(i,a){i&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),r(3),n()(),o(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),r(9,"Type"),n(),o(10,"th"),r(11,"Details"),n(),o(12,"th"),r(13,"Status"),n(),o(14,"th"),r(15,"Actions"),n()()(),o(16,"tbody"),h(17,ve,22,10,"tr",5)(18,we,4,0,"tr",6),n()()(),o(19,"div",7)(20,"button",8),W("click",function(){return a.goBack()}),r(21,"Back to Employees"),n()()()),i&2&&(l(3),d("WORKFLOWS FOR EMPLOYEE ",a.employeeId,""),l(14),s("ngForOf",a.workflows),l(),s("ngIf",!a.workflows.length))},dependencies:[I,C,b,V,H],encapsulation:2})}}return t})();var he=[{path:"",component:ee,children:[{path:"",component:oe},{path:"employee/:id",component:ne}]}],re=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=x({type:t})}static{this.\u0275inj=S({imports:[j.forChild(he),j]})}}return t})();var Be=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=x({type:t})}static{this.\u0275inj=S({imports:[U,Y,re]})}}return t})();export{Be as WorkflowsModule};
