import{a as O}from"./chunk-FFQWOFG3.js";import"./chunk-MMLTXIW5.js";import{$ as y,A as i,Aa as Z,B as c,Ba as ee,Da as D,E as L,Ea as te,F as f,Fa as E,G as b,Ga as ne,Ia as C,K as a,L as h,M as v,P as j,Q as R,R as V,T as w,Z as x,_ as q,ba as z,ha as B,ia as G,ja as N,ka as S,la as W,m as _,ma as $,na as U,o as g,p as M,pa as H,q as P,r as I,sa as J,t as m,ta as K,u as d,ua as Q,v as p,va as X,w as l,x as T,ya as Y,z as r}from"./chunk-U6ZOIJ5K.js";var re=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-departments"]],decls:7,vars:0,consts:[[1,"departments-container"],[1,"header"],["routerLink","add",1,"btn","btn-primary"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"div",1)(2,"h2"),a(3,"Departments"),i(),r(4,"button",2),a(5,"Add Department"),i()(),c(6,"router-outlet"),i())},dependencies:[te,ne],styles:[".departments-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:.5rem 1rem;border-radius:.25rem;cursor:pointer}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3}"]})}}return n})();function ce(n,u){if(n&1){let e=L();r(0,"tr")(1,"td"),a(2),i(),r(3,"td"),a(4),i(),r(5,"td"),a(6),i(),r(7,"td"),a(8),i(),r(9,"td")(10,"span",11),a(11),i()(),r(12,"td")(13,"button",12),f("click",function(){let o=P(e).$implicit,s=b();return I(s.editDepartment(o.id))}),a(14,"Edit"),i(),r(15,"button",13),f("click",function(){let o=P(e).$implicit,s=b();return I(s.deleteDepartment(o.id))}),a(16,"Delete"),i()()()}if(n&2){let e=u.$implicit;T("inactive-row",!e.isActive),m(2),h(e.name),m(2),h(e.code),m(2),h(e.location),m(2),h(e.description),m(2),l("ngClass",e.isActive?"badge-success":"badge-danger"),m(),v(" ",e.isActive?"Active":"Inactive"," ")}}function pe(n,u){n&1&&(r(0,"tr")(1,"td",14),a(2,"No departments found"),i()())}var oe=(()=>{class n{constructor(e,t,o){this.departmentService=e,this.router=t,this.route=o,this.departments=[],this.filteredDepartments=[],this.statusFilter="all"}ngOnInit(){this.loadDepartments()}loadDepartments(){this.departmentService.getAll().subscribe({next:e=>{this.departments=e,this.applyFilters()},error:e=>{console.error("Error loading departments:",e),alert("Failed to load departments: "+(e.message||"Unknown error"))}})}applyFilters(){this.statusFilter==="active"?this.filteredDepartments=this.departments.filter(e=>e.isActive):this.statusFilter==="inactive"?this.filteredDepartments=this.departments.filter(e=>!e.isActive):this.filteredDepartments=[...this.departments]}editDepartment(e){this.router.navigate(["edit",e],{relativeTo:this.route})}deleteDepartment(e){confirm("Are you sure you want to permanently delete this department? This cannot be undone.")&&this.departmentService.delete(e).subscribe({next:()=>{this.departments=this.departments.filter(t=>t.id!==e),this.applyFilters(),alert("Department deleted successfully")},error:t=>{console.error("Error deleting department:",t),alert("Failed to delete department: "+(t.message||"Unknown error"))}})}static{this.\u0275fac=function(t){return new(t||n)(d(O),d(E),d(D))}}static{this.\u0275cmp=g({type:n,selectors:[["app-department-list"]],decls:30,vars:3,consts:[[1,"department-list"],[1,"filter-controls","mb-3"],[1,"status-filter"],[1,"mr-2"],[1,"form-control-sm",3,"ngModelChange","change","ngModel"],["value","all"],["value","active"],["value","inactive"],[1,"table"],[3,"inactive-row",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"badge",3,"ngClass"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],["colspan","6",1,"text-center"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),a(4,"Status Filter:"),i(),r(5,"select",4),V("ngModelChange",function(k){return R(o.statusFilter,k)||(o.statusFilter=k),k}),f("change",function(){return o.applyFilters()}),r(6,"option",5),a(7,"All"),i(),r(8,"option",6),a(9,"Active Only"),i(),r(10,"option",7),a(11,"Inactive Only"),i()()()(),r(12,"table",8)(13,"thead")(14,"tr")(15,"th"),a(16,"Name"),i(),r(17,"th"),a(18,"Code"),i(),r(19,"th"),a(20,"Location"),i(),r(21,"th"),a(22,"Description"),i(),r(23,"th"),a(24,"Status"),i(),r(25,"th"),a(26,"Actions"),i()()(),r(27,"tbody"),p(28,ce,17,8,"tr",9)(29,pe,3,0,"tr",10),i()()()),t&2&&(m(5),j("ngModel",o.statusFilter),m(23),l("ngForOf",o.filteredDepartments),m(),l("ngIf",o.filteredDepartments.length===0))},dependencies:[x,q,y,Q,X,K,S,$],styles:[".department-list[_ngcontent-%COMP%]{padding:1rem 0}.filter-controls[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:1rem}.status-filter[_ngcontent-%COMP%]{display:flex;align-items:center}.mr-2[_ngcontent-%COMP%]{margin-right:.5rem}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}.form-control-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem;border-radius:.2rem;border:1px solid #ced4da}.inactive-row[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#6c757d}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #dee2e6}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:700}.badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.25rem;font-size:.875rem}.badge-success[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.badge-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem;margin-right:.5rem}.btn-info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff;border:none}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none}.btn-info[_ngcontent-%COMP%]:hover{background-color:#138496}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333}.text-center[_ngcontent-%COMP%]{text-align:center}"]})}}return n})();var ae=n=>({"is-invalid":n});function fe(n,u){n&1&&(r(0,"div"),a(1,"Name is required"),i())}function ue(n,u){if(n&1&&(r(0,"div",17),p(1,fe,2,0,"div",18),i()),n&2){let e=b();m(),l("ngIf",e.f.name.errors.required)}}function ge(n,u){n&1&&(r(0,"div"),a(1,"Code is required"),i())}function be(n,u){if(n&1&&(r(0,"div",17),p(1,ge,2,0,"div",18),i()),n&2){let e=b();m(),l("ngIf",e.f.code.errors.required)}}var A=(()=>{class n{constructor(e,t,o,s){this.formBuilder=e,this.route=t,this.router=o,this.departmentService=s,this.loading=!1,this.submitted=!1,this.isEditMode=!1}ngOnInit(){this.id=this.route.snapshot.params.id,this.isEditMode=!!this.id,this.form=this.formBuilder.group({name:["",N.required],code:["",N.required],location:[""],description:[""],isActive:[!0]}),this.isEditMode&&this.loadDepartment()}get f(){return this.form.controls}loadDepartment(){this.departmentService.getById(this.id).subscribe({next:e=>{this.form.patchValue(e)},error:e=>{console.error("Error loading department:",e)}})}onSubmit(){if(this.submitted=!0,this.form.invalid)return;this.loading=!0;let e=this.form.value;console.log("Submitting department form with data:",e),this.isEditMode?this.departmentService.update(this.id,e).subscribe({next:()=>{console.log("Department updated successfully"),this.router.navigate(["/admin/departments"])},error:t=>{console.error("Error updating department:",t);let o="Error updating department";t.error&&t.error.message?o=t.error.message:t.message&&(o=t.message),alert(`Failed to update department: ${o}`),this.loading=!1}}):this.departmentService.create(e).subscribe({next:()=>{console.log("Department created successfully"),this.router.navigate(["/admin/departments"])},error:t=>{console.error("Error creating department:",t);let o="Error creating department";t.error&&t.error.message?o=t.error.message:t.message&&(o=t.message),t.error&&t.error.details&&console.error("Error details:",t.error.details),alert(`Failed to create department: ${o}`),this.loading=!1}})}cancel(){this.router.navigate(["/admin/departments"])}static{this.\u0275fac=function(t){return new(t||n)(d(Y),d(D),d(E),d(O))}}static{this.\u0275cmp=g({type:n,selectors:[["app-department-form"]],decls:32,vars:12,consts:[[1,"department-form"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["type","text","id","name","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","code"],["type","text","id","code","formControlName","code",1,"form-control",3,"ngClass"],["for","location"],["type","text","id","location","formControlName","location",1,"form-control"],["for","description"],["id","description","formControlName","description","rows","3",1,"form-control"],[1,"form-check"],["type","checkbox","id","isActive","formControlName","isActive",1,"form-check-input"],["for","isActive",1,"form-check-label"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-link",3,"click"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"h3"),a(2),i(),r(3,"form",1),f("ngSubmit",function(){return o.onSubmit()}),r(4,"div",2)(5,"label",3),a(6,"Name"),i(),c(7,"input",4),p(8,ue,2,1,"div",5),i(),r(9,"div",2)(10,"label",6),a(11,"Code"),i(),c(12,"input",7),p(13,be,2,1,"div",5),i(),r(14,"div",2)(15,"label",8),a(16,"Location"),i(),c(17,"input",9),i(),r(18,"div",2)(19,"label",10),a(20,"Description"),i(),c(21,"textarea",11),i(),r(22,"div",2)(23,"div",12),c(24,"input",13),r(25,"label",14),a(26,"Active"),i()()(),r(27,"div",2)(28,"button",15),a(29),i(),r(30,"button",16),f("click",function(){return o.cancel()}),a(31,"Cancel"),i()()()()),t&2&&(m(2),v("",o.isEditMode?"Edit":"Add"," Department"),m(),l("formGroup",o.form),m(4),l("ngClass",w(8,ae,o.submitted&&o.f.name.errors)),m(),l("ngIf",o.submitted&&o.f.name.errors),m(4),l("ngClass",w(10,ae,o.submitted&&o.f.code.errors)),m(),l("ngIf",o.submitted&&o.f.code.errors),m(15),l("disabled",o.loading),m(),v(" ",o.loading?"Saving...":"Save"," "))},dependencies:[x,y,U,G,B,S,W,H,J],styles:[".department-form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.form-control[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;line-height:1.5;color:#495057;background-color:#fff;border:1px solid #ced4da;border-radius:.25rem}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.invalid-feedback[_ngcontent-%COMP%]{display:block;width:100%;margin-top:.25rem;font-size:80%;color:#dc3545}.form-check[_ngcontent-%COMP%]{display:flex;align-items:center}.form-check-input[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{margin-right:.5rem}.btn-link[_ngcontent-%COMP%]{color:#6c757d;text-decoration:none}.btn-link[_ngcontent-%COMP%]:hover{color:#0056b3;text-decoration:underline}"]})}}return n})();var he=[{path:"",component:re,children:[{path:"",component:oe},{path:"add",component:A},{path:"edit/:id",component:A}]}],me=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=M({type:n})}static{this.\u0275inj=_({imports:[C.forChild(he),C]})}}return n})();var je=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=M({type:n})}static{this.\u0275inj=_({imports:[z,ee,Z,C,me]})}}return n})();export{je as DepartmentsModule};
